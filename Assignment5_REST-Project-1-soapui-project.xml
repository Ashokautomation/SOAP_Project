<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="b92280d8-e029-4d4d-b402-306d4e89620a" activeEnvironment="Default" name="REST Project 1" resourceRoot="" soapui-version="5.5.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="efe61fb2-0220-4ba3-b3a6-d5c8edc8fc64" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://dummy.restapiexample.com" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://dummy.restapiexample.com</con:endpoint></con:endpoints><con:resource name="GetEemployeesList" path="/api/v1/employees" id="e2fd1c14-1166-4486-a21f-d3c63bca8dca"><con:settings/><con:parameters/><con:method name="GetEmployeeList" id="500d5156-124c-4bc6-bb47-60f8f2cf2124" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>text/html; charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element>html</con:element></con:representation><con:request name="Request 1" id="7bf32282-abf3-4cd8-8f54-ca733ee590f9" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request/><con:originalUri>http://dummy.restapiexample.com/api/v1/employees</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="1" path="/api/v1/employee/{empid}" id="13694fec-b715-41db-a711-8c8c60c5c19d"><con:settings/><con:parameters><con:parameter><con:name>empid</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Method 1" id="d6c0c386-a38e-4f40-bf0c-689964f2f0b8" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>text/html; charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/html;charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element>html</con:element></con:representation><con:request name="Request 1" id="81bfe8eb-746f-4de9-80d0-bbb364d3d780" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request/><con:originalUri>http://dummy.restapiexample.com/api/v1/employee/1</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="empid" value="1" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>empid</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="create" path="/api/v1/create" id="7fdd92bf-2690-4925-886f-bb9ead647b42"><con:settings/><con:parameters/><con:method name="Method 1" id="d75002a9-54dc-4177-b44a-e782e740a1f6" method="POST"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>text/html;charset=UTF-8</con:mediaType><con:status>405 404</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>text/html; charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="Request 1" id="747db821-10d6-49f8-a411-5ef7f873f6f6" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request>{"name":"43434","salary":"123","age":"23"}</con:request><con:originalUri>http://dummy.restapiexample.com/api/v1/create</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry/></con:parameterOrder></con:request></con:method></con:resource><con:resource name="21" path="/api/v1/update/{empid}" id="cb051944-929e-4cec-a4c0-37eafed304c5"><con:settings/><con:parameters><con:parameter><con:name>empid</con:name><con:style>TEMPLATE</con:style></con:parameter></con:parameters><con:method name="Method 1" id="dddeb1f9-743e-41a0-8b33-3ee9af757ccc" method="PUT"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>text/html;charset=UTF-8</con:mediaType><con:status>404 405</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>text/html; charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="Update" id="3aac9807-1558-4f57-8ad5-42c9d3b77172" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request>{"name":"test123","salary":"1123","age":"23"}</con:request><con:originalUri>http://dummy.restapiexample.com/api/v1/employee/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="2" path="/api/v1/delete/2" id="accdb8f4-5d78-4382-b025-0431058d8ead"><con:settings/><con:parameters/><con:method name="Method 1" id="037273ef-9874-49ad-b94f-e6c4ab6cb7e3" method="GET"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>text/html;charset=UTF-8</con:mediaType><con:status>405</con:status><con:params/><con:element>html</con:element></con:representation><con:request name="Request 1" id="a1818c0d-101f-46b6-924f-db5988360509" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request/><con:originalUri>http://dummy.restapiexample.com/api/v1/delete/2</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="fbf2e0b0-2c83-4fb7-a170-52a956ba11f4" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Project 1" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints/><con:resource name="" path="rest/v2/all" id="d836d322-16c0-416e-9f1a-4c5de0e8beae"><con:settings/><con:parameters/><con:method name="All1" id="303ec3e8-7940-4882-9cb0-aab195b52e59" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=utf-8</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="372092e1-4602-4ae4-9bfc-5c077c3ae98d" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://restcountries.eu</con:endpoint><con:request/><con:originalUri>https://restcountries.eu/rest/v2/all</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="c69eaa9d-c752-402e-a1c4-7bab1c729215" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="97f81e8d-efd6-4d09-b404-2d1c1ace4eea" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetEmpDetails" id="bde6a80c-fc74-4297-9449-88e850ec8a5c"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/employee/{empid}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetEmpDetails" id="81bfe8eb-746f-4de9-80d0-bbb364d3d780" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request/><con:originalUri>http://dummy.restapiexample.com/api/v1/employee/1</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="empid" value="${EMPID_Property#empid}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>empid</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="properties" name="EMPID_Property" id="bd0ad640-832b-4dd0-98e4-d0a0ebb62447"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>empid</con:name><con:value>1</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="UpdateEmp" id="f5b2948b-0d9f-4f58-a03b-d046ca9032df"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/update/{empid}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="UpdateEmp" id="3aac9807-1558-4f57-8ad5-42c9d3b77172" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request>{"name":"test12345","salary":"1123","age":"23"}</con:request><con:originalUri>http://dummy.restapiexample.com/api/v1/employee/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Read_Properties" id="befd60f5-6b16-4ead-b3ea-efe75bb20787"><con:settings/><con:config><script>


//Get a Env property
def envprop = context.expand("${#Env#Path}')
log.info("The property is " + envprop)</script></con:config></con:testStep><con:testStep type="groovy" name="GettingAndSettingproperties" id="42284b58-07cc-4335-951a-9db34bc21502"><con:settings/><con:config><script>// Remove property
//Project
testRunner.testCase.testSuite.project.removeProperty("Name");

//TestSuite
testRunner.testCase.testSuite.removeProperty("Name")</script></con:config></con:testStep><con:properties><con:property><con:name>TestCase_prop</con:name><con:value>am testcase level property</con:value></con:property><con:property><con:name>empid_TC</con:name><con:value>98062</con:value></con:property><con:property><con:name>Name</con:name><con:value>I am in TestCase</con:value></con:property></con:properties></con:testCase><con:testCase id="80522555-e513-496a-ad9f-6ceab6910f2b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase_create" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="Create_empid" id="f83f9150-1977-4be8-b96d-bd7638fdee66"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Create_empid" id="747db821-10d6-49f8-a411-5ef7f873f6f6" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request>{"name":"22222","salary":"123","age":"23"}</con:request><con:originalUri>http://dummy.restapiexample.com/api/v1/create</con:originalUri><con:assertion type="Simple Contains" id="f0b85ab6-c59a-421e-bacf-a1d5f2c0d13f" name="Contains"><con:configuration><token/><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry/></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="properties" name="create_empid_property" id="ec744496-bf0a-4408-b05e-6a4465f6f7b2"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>empid</con:name><con:value>22222</con:value></con:property></con:properties></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="1888a387-d767-4d31-a9b8-e2d7b24f8462" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DataDrivenExcel" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Data Source" id="b07cd15c-d90c-4d10-b5a7-a64429ba3812"><con:settings/><con:config><script>// import Java Excel API library
import jxl.* 
import jxl.write.*
def TestCase = context.testCase
def FilePath = "C:\\Users\\AshokBellary\\Desktop\\REST_Testdata.xls"
def count
Workbook WorkBook1 = Workbook.getWorkbook(new File(FilePath))
Sheet Sheet1 = WorkBook1.getSheet(0)
PropertiesTestStep = TestCase.getTestStepByName("Properties")
count = PropertiesTestStep.getPropertyValue("counter").toInteger() 
//If Total records is unknown (at start), get the rowcount from Excel
if (PropertiesTestStep.getPropertyValue("total").toString() == "")
    PropertiesTestStep.setPropertyValue("total", Sheet1.getRows().toString())   
    count++    
    //Read the Excel test data
Cell Field1 = Sheet1.getCell(0, count)
//Cell Field2 = Sheet1.getCell(1, count)
log.info ("Count is " + count.toString() + " Employee ID " + Field1.getContents() 
                
//Close workbook.
WorkBook1.close()


//Copy the Excel test data to properties in Properties test step
PropertiesTestStep.setPropertyValue("intA", Field1.getContents())
PropertiesTestStep.setPropertyValue("intB", Field2.getContents())
PropertiesTestStep.setPropertyValue("counter", count.toString())
// check the counter value is less than total no of rows. If same set prop 'end' to 'true'
if (count == PropertiesTestStep.getPropertyValue("total").toInteger() - 1)
    PropertiesTestStep.setPropertyValue("end", "true")
    </script></con:config></con:testStep><con:testStep type="properties" name="Properties" id="fcfab868-fa95-46c2-8a08-270ddb457eec"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>empid</con:name><con:value/></con:property><con:property><con:name>counter</con:name><con:value/></con:property><con:property><con:name>end</con:name><con:value/></con:property><con:property><con:name>total</con:name><con:value/></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="EmployeeDetails" id="7742b482-6466-4fd1-b02c-0faee8fc566c"><con:settings/><con:config service="http://dummy.restapiexample.com" resourcePath="/api/v1/employees" methodName="GetEmployeeList" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="EmployeeDetails" id="7bf32282-abf3-4cd8-8f54-ca733ee590f9" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://dummy.restapiexample.com</con:endpoint><con:request/><con:originalUri>http://dummy.restapiexample.com/api/v1/employees</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Data Loop" id="b6a4ea61-5006-4ecd-9d90-f785564155f4"><con:settings/><con:config><script>// declare context, property step
def TestCase = context.testCase
PropertiesTestStep = TestCase.getTestStepByName("Properties")
// get prop value for 'end'
Stop = PropertiesTestStep.getPropertyValue("end").toString()
if (Stop=="true")
    log.info("Data Loop")
else
    testRunner.gotoStepByName("Data Source")</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="ef2ae760-068d-4a55-8d0f-5c601517aab1" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="DataDrivenExcel1" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Data Source" id="d94b98e1-59fe-4ac6-af41-3644544cfb2b"><con:settings/><con:config><script/></con:config></con:testStep><con:testStep type="groovy" name="Data Loop" id="7e62ccce-1f02-4fa5-9420-2a7384c4049b"><con:settings/><con:config><script/></con:config></con:testStep><con:testStep type="properties" name="Properties" id="bc606453-31f5-4eb0-a244-5610cda3b9a0"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:properties><con:property><con:name>TestSuite_prop</con:name><con:value>i am a test suite property</con:value></con:property><con:property><con:name>empid</con:name><con:value>98063</con:value></con:property></con:properties></con:testSuite><con:properties><con:property><con:name>Project_prop</con:name><con:value>I am a project level property</con:value></con:property><con:property><con:name>New_Prop1</con:name><con:value>I am in Project</con:value></con:property><con:property><con:name>EMP</con:name></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>